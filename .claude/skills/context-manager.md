# Context Manager - Менеджер Контекста

**Описание:** Агент для управления контекстом и предотвращения потери важной информации при достижении лимита токенов.

## Основные функции

### 1. Мониторинг использования токенов
- Отслеживай текущее использование контекста
- Предупреждай когда остается < 20% токенов
- Критическое предупреждение при < 10%

### 2. Сохранение состояния проекта

Когда контекст заканчивается, ОБЯЗАТЕЛЬНО сохрани:

```markdown
## СОСТОЯНИЕ ПРОЕКТА SATURWAY

### Что СДЕЛАНО:
- Frontend: [список готовых компонентов]
- Backend: [что реализовано]
- Database: [схема и миграции]
- Integration: [что подключено]

### Что В ПРОЦЕССЕ:
- [текущая задача с деталями]

### Что ОСТАЛОСЬ:
- [приоритетные задачи]

### ВАЖНЫЕ РЕШЕНИЯ:
- [технические решения которые нельзя забыть]

### ФАЙЛЫ ИЗМЕНЕНЫ:
- [список с указанием что изменено]

### СЛЕДУЮЩИЕ ШАГИ:
1. [конкретный next step]
2. [еще шаг]
```

### 3. Критическая информация для сохранения

**ВСЕГДА сохраняй:**
- Структуру БД и схему таблиц
- API endpoints и их сигнатуры
- Конфигурация (порты, URL, ключи)
- Важные бизнес-логики и алгоритмы
- Нерешенные проблемы и баги
- Зависимости между компонентами

**НЕ ЗАБЫВАЙ:**
- Пути к файлам которые нужно изменить
- Команды для запуска/сборки
- Environment переменные
- Третьесторонние API ключи (где их взять)

### 4. Создание чекпоинтов

При каждом важном этапе создавай файл чекпоинта:

```bash
# Создай .claude/checkpoints/checkpoint-YYYYMMDD-HHMM.md
```

Содержание:
```markdown
# Checkpoint: [Название этапа]
Дата: [timestamp]

## Достигнуто:
- [что сделано]

## Конфигурация:
- Database: [connection string]
- Backend URL: [url]
- Frontend URL: [url]

## Команды:
```bash
# Start backend
npm run dev

# Start frontend
npm run dev
```

## Проблемы:
- [известные issues]

## Next:
- [что делать дальше]
```

### 5. Действия при критическом уровне контекста

Когда токены на исходе:

1. **Сохрани текущее состояние** в README.md проекта
2. **Создай чекпоинт** с полной информацией
3. **Коммит в git** если возможно
4. **Создай новый TODO** файл с оставшимися задачами
5. **Запиши важные команды** для продолжения работы

### 6. Формат важных заметок

Создай файл `.claude/context.md`:

```markdown
# КРИТИЧЕСКИЙ КОНТЕКСТ ПРОЕКТА

## Архитектура:
- Frontend: React + TypeScript + Vite
- Backend: Node.js + Fastify
- DB: PostgreSQL
- Bot: Telegram Mini App

## Текущая задача MVP:
[Детальное описание что делаем сейчас]

## Ключевые файлы:
- saturway-app/src/store.ts - State management
- saturway-backend/server.js - Main backend
- ТЗ.txt - Техническое задание

## Команды для быстрого старта:
```bash
cd saturway-app && npm run dev
cd saturway-backend && npm run dev
```

## Проблемы требующие внимания:
1. [issue 1]
2. [issue 2]

## Не забыть:
- [критически важная информация]
```

### 7. Предупреждающие сигналы

Выдай предупреждение если:
- Использовано > 150,000 токенов из 200,000
- Открыто много больших файлов
- Делается сложная задача без сохранения прогресса
- Нет чекпоинтов > 30 минут работы

### 8. Recovery план

Если контекст был потерян:

1. Прочитай `.claude/context.md`
2. Проверь последний чекпоинт
3. Посмотри git log
4. Прочитай README.md проекта
5. Запусти project-validator skill

## Использование

Автоматически активируется:
- Каждые 50,000 токенов
- При завершении крупной задачи
- По запросу пользователя

Ручной вызов:
```
Запусти context-manager для сохранения текущего состояния
```
